"use strict";angular.module("myApp",["ngRoute"]).config(["$routeProvider","$locationProvider",function(t,e){t.when("/",{templateUrl:"app/view/address-book.html",controller:"addressCtrl"})}]),angular.module("myApp").controller("addressCtrl",["$rootScope","$scope","$location","$http",function(t,e,a,n){function o(){$.get(i,function(t){c.contactList=t.contactList;var e=0;t.contactList.forEach(function(t){var a=t.first_name[0].toUpperCase(),n=t.last_name[0].toUpperCase(),o=Math.floor(6*Math.random());c.contactList[e].initials=a+n,c.contactList[e].colour=l[o],e++}),c.$digest(),r()})}var c=e,i="http://60.242.62.79:5000/contacts",l=["#db4540","#384c7a","#6cde9b","#b07142","#b771e0","#e6d698"];c.contactDetailEditMode=!1,c.contactList="",c.sortByValue="first_name",c.dialogAddNewContact={inputValues:{first_name:"",last_name:"",email:"",phone_mob:"",phone_home:"",phone_work:"",gender:""}},c.dialogContactDetail={contactDetail:{}},o(),c.handleSort=function(t){return c.sortByValue=$("#sortby").val()},c.handleDeleteContact=function(t){return s(t)},c.handleSortByChange=function(t){return c.checkActive(t)},c.handleclearAllFields=function(){return h()},c.checkAddNewClearButton=function(){return c.checkAddNewContactClearAllButton()},c.handleEditMode=function(){return c.contactDetailEditMode=!c.contactDetailEditMode},c.handleDialog=function(t,e,a){var n=$(e);if(a)".dialog-contact"==e&&c.contactDetailEditMode&&(c.contactDetailEditMode=!c.contactDetailEditMode),n.removeAttr("opened"),$(".container").removeAttr("faded");else{if(".dialog-contact"==e){var o=t.currentTarget.firstElementChild.dataset.id;f(o)}n.attr("opened",!a),$(".container").attr("faded",!0),n.css("pointer-events","all")}},c.handleAddNewContact=function(t){var e=p("object");d(e)},c.checkActive=function(t){return c.sortByValue==t?"":"active"},c.checkAddNewContactClearAllButton=function(){var t=p("array");for(var e in t)if(t[e])return"active"},c.makeButtonActive=function(){var t=p("object");if(t.first_name&&t.last_name)return"active"},c.handleUpdatedContactDetails=function(){var t=c.dialogContactDetail.contactDetail,e=t.colour,a=t.initials,n=t.$$hashKey;delete t.$$hashKey,delete t.colour,delete t.initials,u(t),c.contactDetailEditMode=!c.contactDetailEditMode,c.dialogContactDetail.contactDetail.colour=e,c.dialogContactDetail.contactDetail.initials=a,c.dialogContactDetail.contactDetail.$$hashKey=n};var r=function(){var t=$(".listview-header"),e=t[0].clientWidth,a=$(".listview")[0].clientWidth;if(e>a){var n=-Math.abs(e-a);t.css("left",n+"px")}else t.css("left","0px")},d=function(t){$.post(i,t,function(t,e){console.log("response "+t),console.log("status "+e),"success"==e&&(h(),o())})},s=function(t){$.ajax({url:i+"/"+t,type:"delete",success:function(){c.handleDialog(null,".dialog-contact",!0),o()},error:function(t){return console.log(t)}})},u=function(t){$.ajax({url:i+"/"+t.id,type:"put",data:t,error:function(t){return console.log(t)}})},f=function(t){c.contactList.forEach(function(e){e.id==t&&(c.dialogContactDetail.contactDetail=e)})},h=function(){var t=c.dialogAddNewContact.inputValues;for(var e in t)t[e]=""},p=function(t){var e=c.dialogAddNewContact.inputValues;switch(t){case"array":var a=[];for(var n in e)a.push(e[n]);return a;case"object":return e}};c.$watch("sortByValue",function(t,e){}),c.$watch("dialogAddNewContact.inputValues",function(t,e){t=JSON.stringify(t);t.firstname},!0)}]);