"use strict";var app=angular.module("myApp",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(t,e){t.when("/",{templateUrl:"app/view/address-book.html",controller:"addressCtrl"}).otherwise({redirectTo:"/"})}]),app.factory("dialogService",function(){function t(t){this.class=t,this.active=!1}return t.prototype.getClass=function(){return this.class},t.prototype.getState=function(){return this.active},{new:t}}),app.service("dialogSettingService",function(){this.createNew={active:!1},this.contactDetail={active:!1},this.setting={active:!0}}),app.directive("customDialog",[function(){return{restrict:"E",scope:{title:"=",class:"="},transclude:{body:"?dialogBody",footer:"?dialogFooter"},templateUrl:"app/view/custom-directives/custom-dialog.html",controller:"@",name:"testController"}}]),app.service("myService",function(){var t=!1,e=["#db4540","#384c7a","#6cde9b","#b07142","#b771e0","#e6d698"];this.getColours=function(t){return e[t]},this.setContactList=function(t){this.contactList=t},this.getContactList=function(t){if(!t)return this.contactList;for(var e in this.contactList)if(this.contactList[e].id==t)return this.contactList[e]},this.getInitialised=function(){return t},this.setInitialised=function(){t=!0}}),app.factory("myFactory",["$http",function(t){var e="http://60.242.62.79:5000/contacts",n={};return n.getContacts=function(){return t.get(e)},n.insertContact=function(n){return t.post(e,n)},n.updateContact=function(n,o){return t.put(e+"/"+n,o)},n.deleteContact=function(n){return t.delete(e+"/"+n)},n}]),app.factory("buttonFactory",function(){function t(t){this.active=t||!1}return t.prototype.getActive=function(){return this.active},t.prototype.validate=function(t,e){"function"==typeof t&&(this.active=t(e))},t.prototype.handleClick=function(t,e){"function"==typeof t&&t(e)},{new:t}}),app.controller("addressCtrl",["$rootScope","$scope","$location","myFactory","myService","dialogService","buttonFactory","dialogSettingService",function(t,e,n,o,i,c,a,l){function r(t){var n={};for(var o in t)switch(o){case"$$hashKey":case"colour":case"initials":break;default:n[o]=t[o]}d(n),e.contactDetailEditMode=!e.contactDetailEditMode}function s(t){o.insertContact(t).then(function(t){console.log("succesfully inserted"),e.handleNewContactClearAllClick(),f()},function(t){console.log(t)})}function u(t){o.deleteContact(t).then(function(t){console.log("successfully deleted"),e.handleDialog(null,".dialog-contact",!0),f()},function(t){console.log(t)})}function d(t){o.updateContact(t.id,t).then(function(t){console.log("succesfully inserted")},function(t){console.log(t)})}function f(){o.getContacts().then(function(t){var n=t.data.contactList,o=0;n.forEach(function(t){var e=t.first_name[0].toUpperCase(),c=t.last_name[0].toUpperCase(),a=Math.floor(6*Math.random());n[o].initials=e+c,n[o].colour=i.getColours(a),o++}),i.setContactList(n),e.contactList=i.getContactList(),setTimeout(function(){g()},1)},function(t){console.log(t)})}!function(){i.getInitialised()===!1&&(f(),i.setInitialised())}(),e.toggleSettingDialog=function(){t.$emit("toggleDialogSetting",{})},e.toggleAddNewDialog=function(){t.$emit("toggleDialogAddNew",{})},e.toggleContactDialog=function(){t.$emit("toggleDialogContact",{})},e.contactDetailEditMode=!1,e.sortByValue="first_name",e.newContact={},e.settingApply=new a.new,e.newContactClearAll=new a.new,e.newContactSubmit=new a.new,e.contactDetailEdit=new a.new(!0),e.contactDetailCancel=new a.new(!0),e.contactDetailDelete=new a.new(!0),e.contactDetailSave=new a.new(!0),e.handleSettingValidate=function(t){return t!=e.sortByValue},e.handleSettingSubmit=function(){e.sortByValue=$("#sortby").val(),e.settingApply.active=!1},e.handleNewContactClearAllValidate=function(t){for(var e in t)if(t[e].length>0)return!0;return!1},e.handleNewContactClearAllClick=function(){for(var t in e.newContact)e.newContact[t]="";e.newContactClearAll.active=!1},e.handleNewContactSubmitValidate=function(t){return!(!t.first_name||!t.last_name)},e.handleNewContactSubmitClick=function(){s(e.newContact),e.newContactSubmit.active=!1},e.handleContactDetailEditClick=function(){e.contactDetailEditMode=!e.contactDetailEditMode},e.handleContactDetailCancelClick=function(){e.contactDetailEditMode=!e.contactDetailEditMode},e.handleContactDetailDeleteClick=function(t){u(t)},e.handleContactDetailSaveClick=function(t){r(t)},e.handleDialog=function(t,n,o){var c=$(n);if(o)".dialog-contact"==n&&e.contactDetailEditMode&&(e.contactDetailEditMode=!e.contactDetailEditMode),c.removeAttr("opened"),$(".container").removeAttr("faded");else{if(".dialog-contact"==n){var a=t.currentTarget.firstElementChild.dataset.id;e.contactDetail=i.getContactList(a)}c.attr("opened",!o),$(".container").attr("faded",!0),c.css("pointer-events","all")}};var g=function(){try{var t=$(".listview-header")||!1,e=t[0].clientWidth,n=$(".listview")[0].clientWidth;if(e>n){var o=-Math.abs(e-n);t.css("left",o+"px")}else t.css("left","0px")}catch(t){console.log(t)}};e.$watch("sortByValue",function(t,e){}),e.$watch(e.newContact,function(t,e){console.log("watchedwatched")})}]),app.controller("dialogAddNewCtrl",["$scope","$rootScope","myFactory","myService","dialogService",function(t,e,n,o,i){t.openState=!1,e.$on("toggleDialogAddNew",function(){t.toggle()}),t.toggle=function(){t.openState=!t.openState}}]),app.controller("dialogContactCtrl",["$scope","$rootScope","myFactory","myService","dialogService",function(t,e,n,o,i){t.openState=!1,e.$on("toggleDialogContact",function(){t.toggle()}),t.toggle=function(){t.openState=!t.openState}}]),app.controller("dialogSettingCtrl",["$scope","$rootScope","myFactory","myService","dialogService",function(t,e,n,o,i){console.log("party from settings"),t.openState=!1,t.testwhichcontroller="this controller",e.$on("toggleDialogSetting",function(){t.toggle()}),t.toggle=function(){t.openState=!t.openState}}]);